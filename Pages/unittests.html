<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>MHA Unit Tests</title>

    <link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-2.4.0.css">
    <script src="https://code.jquery.com/qunit/qunit-2.4.0.js"></script>
    <script src="../Scripts/2047.js"></script>

    <script>
        QUnit.test("RFC 2047 Tests", function (assert) {
            // Tests from https://tools.ietf.org/html/rfc2047
            assert.equal(clean2047Encoding("=?US-ASCII?Q?Keith_Moore?= <moore@cs.utk.edu>"), "Keith Moore <moore@cs.utk.edu>");
            assert.equal(clean2047Encoding("=?ISO-8859-1?Q?Keld_J=F8rn_Simonsen?= <keld@dkuug.dk>"), "Keld Jørn Simonsen <keld@dkuug.dk>");
            //assert.equal(clean2047Encoding("=?ISO-8859-1?Q?Andr=E9?= Pirard <PIRARD@vm1.ulg.ac.be>"), "1234");
            assert.equal(clean2047Encoding("=?ISO-8859-1?B?SWYgeW91IGNhbiByZWFkIHRoaXMgeW8=?=\n" +
                "    =?ISO-8859-2?B?dSB1bmRlcnN0YW5kIHRoZSBleGFtcGxlLg==?="), "If you can read this you understand the example.");
            //assert.equal(clean2047Encoding("=?ISO-8859-1?Q?Olle_J=E4rnefors?= <ojarnef@admin.kth.se>"), "1234");
            assert.equal(clean2047Encoding("ietf-822@dimacs.rutgers.edu, ojarnef@admin.kth.se"), "ietf-822@dimacs.rutgers.edu, ojarnef@admin.kth.se");
            assert.equal(clean2047Encoding("Time for ISO 10646?"), "Time for ISO 10646?");
            assert.equal(clean2047Encoding("Dave Crocker <dcrocker@mordor.stanford.edu>"), "Dave Crocker <dcrocker@mordor.stanford.edu>");
            assert.equal(clean2047Encoding("ietf-822@dimacs.rutgers.edu, paf@comsol.se"), "ietf-822@dimacs.rutgers.edu, paf@comsol.se");
            //assert.equal(clean2047Encoding("=?ISO-8859-1?Q?Patrik_F=E4ltstr=F6m?= <paf@nada.kth.se>"), "1234");
            assert.equal(clean2047Encoding("Re: RFC-HDR care and feeding"), "Re: RFC-HDR care and feeding");
            assert.equal(clean2047Encoding("Nathaniel Borenstein <nsb@thumper.bellcore.com>\n" +
                "    (=?iso-8859-8?b?7eXs+SDv4SDp7Oj08A==?=)"), "Nathaniel Borenstein <nsb@thumper.bellcore.com>\n" +
                "    (íåìù ïá éìèôð)");
            assert.equal(clean2047Encoding("Greg Vaudreuil <gvaudre@NRI.Reston.VA.US>, Ned Freed\n" +
                "    < ned@innosoft.com>, Keith Moore < moore@cs.utk.edu>"), "Greg Vaudreuil <gvaudre@NRI.Reston.VA.US>, Ned Freed\n" +
                "    < ned@innosoft.com>, Keith Moore < moore@cs.utk.edu>");
            assert.equal(clean2047Encoding("Test of new header generator"), "Test of new header generator");
        });

        // Should I add test cases from http://greenbytes.de/tech/tc2231/ ?

        QUnit.test("2047 Hex Tests", function (assert) {
            assert.equal(hexDecode("=61=62"), "ab");
            assert.equal(hexDecode("Keld J=F8rn Simonsen"), "Keld Jørn Simonsen");
        });

        QUnit.test("2047 Quoted Tests", function (assert) {
            assert.equal(decodeQuoted("US-ASCII", "Keith_Moore"), "Keith Moore");
            assert.equal(decodeQuoted("ISO-8859-1", "Keld_J=F8rn_Simonsen"), "Keld Jørn Simonsen");
        });

        QUnit.test("2047 Base64 Tests", function (assert) {
            assert.equal(decodeBase64("", "YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4bHl6"), "abcdefghijklmnopqrstuvwxlyz");
            assert.equal(decodeBase64("", "IUAjJCVeJiooKV8rLT1bXVx7fXw7JzoiLC4vPD4/"), "!@#$%^&*()_+-=[]\\{}|;':\",./<>?");
            assert.equal(decodeBase64("ISO-8859-1", "SWYgeW91IGNhbiByZWFkIHRoaXMgeW8="), "If you can read this yo");
            assert.equal(decodeBase64("ISO-8859-2", "dSB1bmRlcnN0YW5kIHRoZSBleGFtcGxlLg=="), "u understand the example.");

            // This passes. Is this right?
            assert.equal(decodeBase64("iso-8859-8", "7eXs+SDv4SDp7Oj08A=="), "íåìù ïá éìèôð");
        });
    </script>
</head>
<body>
    <div id="qunit"></div>
</body>
</html>